{% extends 'layout.html' %}

{% block title %}{{ post.title }} - MiniBlog{% endblock %}

{% block content %}
<h1>{{ post.title }}</h1>
<p>por {{ post.author.name }} el {{ post.created_at.strftime('%Y-%m-%d %H:%M') }}</p>

<div>
  {{ post.content }}
</div>

<p><strong>Categorías:</strong>
  {% if post.categories %}
    {% for cat in post.categories %}
      {{ cat.name }}{% if not loop.last %}, {% endif %}
    {% endfor %}
  {% else %}
    Sin categorías
  {% endif %}
</p>

<hr>
<h2>Comentarios</h2>

<ul>
  {% if post.comments %}
    {% for comment in post.comments %}
      <li>
        <strong>{{ comment.author.name }}</strong> dijo:<br>
        {{ comment.text }}<br>
        <small>{{ comment.created_at.strftime('%Y-%m-%d %H:%M') }}</small>
      </li>
    {% endfor %}
  {% else %}
    <li>No hay comentarios aún.</li>
  {% endif %}
</ul>

<hr>
{% if current_user %}
  <h3>Agregar comentario</h3>
  <form method="post">
    <textarea name="comment" rows="3" cols="40" required></textarea><br>
    <input type="submit" value="Enviar comentario">
  </form>
{% else %}
  <p><a href="{{ url_for('login') }}">Inicia sesión</a> para agregar un comentario.</p>
{% endif %}

<br>
<a href="{{ url_for('index') }}">&larr; Volver al inicio</a>
{% endblock %}
